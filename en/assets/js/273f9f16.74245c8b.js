"use strict";(self.webpackChunkdocsweb=self.webpackChunkdocsweb||[]).push([[7187],{876:(e,a,n)=>{n.d(a,{Zo:()=>m,kt:()=>g});var t=n(2784);function r(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function s(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function i(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?s(Object(n),!0).forEach((function(a){r(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function o(e,a){if(null==e)return{};var n,t,r=function(e,a){if(null==e)return{};var n,t,r={},s=Object.keys(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||(r[n]=e[n]);return r}(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=t.createContext({}),c=function(e){var a=t.useContext(l),n=a;return e&&(n="function"==typeof e?e(a):i(i({},a),e)),n},m=function(e){var a=c(e.components);return t.createElement(l.Provider,{value:a},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},u=t.forwardRef((function(e,a){var n=e.components,r=e.mdxType,s=e.originalType,l=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),d=c(n),u=r,g=d["".concat(l,".").concat(u)]||d[u]||p[u]||s;return n?t.createElement(g,i(i({ref:a},m),{},{components:n})):t.createElement(g,i({ref:a},m))}));function g(e,a){var n=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var s=n.length,i=new Array(s);i[0]=u;var o={};for(var l in a)hasOwnProperty.call(a,l)&&(o[l]=a[l]);o.originalType=e,o[d]="string"==typeof e?e:r,i[1]=o;for(var c=2;c<s;c++)i[c]=n[c];return t.createElement.apply(null,i)}return t.createElement.apply(null,n)}u.displayName="MDXCreateElement"},4316:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var t=n(7896),r=(n(2784),n(876));const s={title:"Detecci\xf3n de anomal\xedas",date:new Date("2023-06-20T00:00:00.000Z"),authors:["ccdarvin"],tags:["machine learning","python"]},i="\xbfQue es la deteccion de anomalias?",o={permalink:"/en/article/ml-deteccion-de-anomalias",source:"@site/blog/ml-deteccion-de-anomalias.md",title:"Detecci\xf3n de anomal\xedas",description:"La detecci\xf3n de anomal\xedas es el proceso de identificar patrones",date:"2023-06-20T00:00:00.000Z",formattedDate:"June 20, 2023",tags:[{label:"machine learning",permalink:"/en/article/tags/machine-learning"},{label:"python",permalink:"/en/article/tags/python"}],readingTime:2.71,hasTruncateMarker:!1,authors:[{name:"Darvin Cotrina",title:"Creador de entredata.org",url:"https://github.com/ccdarvin",imageURL:"https://github.com/ccdarvin.png",key:"ccdarvin"}],frontMatter:{title:"Detecci\xf3n de anomal\xedas",date:"2023-06-20T00:00:00.000Z",authors:["ccdarvin"],tags:["machine learning","python"]},prevItem:{title:"Brocasting con Numpy",permalink:"/en/article/brocasting-con-numpy"},nextItem:{title:"Expresiones regulares en Python",permalink:"/en/article/expresiones-regulares-python"}},l={authorsImageUrls:[void 0]},c=[{value:"Estimaci\xf3n de densidad",id:"estimaci\xf3n-de-densidad",level:2},{value:"Algoritmo de detecci\xf3n de anomal\xedas",id:"algoritmo-de-detecci\xf3n-de-anomal\xedas",level:2},{value:"Escoger que caracteristicas usar",id:"escoger-que-caracteristicas-usar",level:2},{value:"Caracteristicas no gaussianas",id:"caracteristicas-no-gaussianas",level:3},{value:"Error en el analisis para detecci\xf3n de anomal\xedas",id:"error-en-el-analisis-para-detecci\xf3n-de-anomal\xedas",level:3}],m={toc:c},d="wrapper";function p(e){let{components:a,...s}=e;return(0,r.kt)(d,(0,t.Z)({},m,s,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"La detecci\xf3n de anomal\xedas es el proceso de identificar patrones\ninusuales en los datos. Es un problema de aprendizaje no supervisado, lo\nque significa que no necesitamos tener etiquetas para entrenar nuestro\nmodelo. En cambio, nuestro modelo aprender\xe1 a identificar patrones\ninusuales en los datos por s\xed mismo."),(0,r.kt)("p",null,"La detecci\xf3n de anomal\xedas se puede aplicar a una amplia gama de\ndominios, como la detecci\xf3n de fraudes con tarjetas de cr\xe9dito, la\ndetecci\xf3n de fallas en equipos de fabricaci\xf3n o la detecci\xf3n de\nanomal\xedas m\xe9dicas."),(0,r.kt)("h2",{id:"estimaci\xf3n-de-densidad"},"Estimaci\xf3n de densidad"),(0,r.kt)("p",null,"La detecci\xf3n de anomal\xedas se puede realizar utilizando un modelo de\nestimaci\xf3n de densidad. La idea es que los datos normales se\ndistribuir\xe1n de manera diferente a los datos anormales. Por lo tanto,\npodemos estimar la densidad de los datos normales y luego identificar\nlos puntos de datos que tienen una densidad significativamente menor\ncomo anomal\xedas."),(0,r.kt)("p",null,"Dado el conjunto de datos de entrenamiento ","$"," {x^{(1)}, x^{(2)}, ,\nx^{(m)} } ","$",", donde cada ejemplo tiene ","$"," n ","$"," caracter\xedsticas, podemos\nestimar la densidad de los datos como:"),(0,r.kt)("p",null,"$$ p(x) = p(x",(0,r.kt)("em",{parentName:"p"},"1; \\mu_1, \\sigma_1^2) \\times p(x_2; \\mu_2, \\sigma_2^2) \\times \\ldots \\times p(x_n; \\mu_n, \\sigma_n^2) ",(0,r.kt)("span",{parentName:"em",className:"math math-inline"},(0,r.kt)("span",{parentName:"span",className:"katex"},(0,r.kt)("span",{parentName:"span",className:"katex-mathml"},(0,r.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,r.kt)("semantics",{parentName:"math"},(0,r.kt)("mrow",{parentName:"semantics"}),(0,r.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,r.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"})))," = \\prod"),"{j=1}^n p(x_j; \\mu_j, \\sigma_j^2) $$"),(0,r.kt)("h2",{id:"algoritmo-de-detecci\xf3n-de-anomal\xedas"},"Algoritmo de detecci\xf3n de anomal\xedas"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Elija las caracter\xedsticas ","$"," x_i ","$"," que crea que pueden indicar\nanomal\xedas.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Ajuste los par\xe1metros ","$"," ","_","1, , ","_","n, ","_","1^2, , ","_","n^2 ","$"," en el\nconjunto de entrenamiento ","$"," {x^{(1)}, x^{(2)}, , x^{(m)} } ","$",".\n$$ \\vec{\\mu} = \\frac{1}{m} \\sum",(0,r.kt)("em",{parentName:"p"},"{i=1}^m \\vec{x^{(i)}} ",(0,r.kt)("span",{parentName:"em",className:"math math-inline"},(0,r.kt)("span",{parentName:"span",className:"katex"},(0,r.kt)("span",{parentName:"span",className:"katex-mathml"},(0,r.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,r.kt)("semantics",{parentName:"math"},(0,r.kt)("mrow",{parentName:"semantics"}),(0,r.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"})))),(0,r.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"})))," \\vec{\\sigma^2} = \\frac{1}{m} \\sum"),"{i=1}^m (\\vec{x^{(i)}} - \\vec{\\mu})^2 $$")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Dado un nuevo ejemplo ","$"," x ","$",", compute ","$"," p(x) ","$",":"))),(0,r.kt)("p",null,"$$ p(x) = \\prod",(0,r.kt)("em",{parentName:"p"},"{j=1}^n p(x_j; \\mu_j, \\sigma_j^2) = \\prod"),"{j=1}^n \\frac{1}{\\sqrt{2\\pi}\\sigma_j} \\exp \\left( - \\frac{(x_j - \\mu_j)^2}{2\\sigma_j^2} \\right) $$"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Si ","$"," p(x) \\< ","$",", marque un ejemplo de anomal\xeda.")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image.png",src:n(6026).Z,width:"866",height:"628"})),(0,r.kt)("h2",{id:"escoger-que-caracteristicas-usar"},"Escoger que caracteristicas usar"),(0,r.kt)("p",null,"En Deteci\xf3n de Anomal\xedas, se debe escoger que caracteristicas usar, ya\nque si se usan todas las caracteristicas, el algoritmo no funcionar\xe1\ncorrectamentem."),(0,r.kt)("h3",{id:"caracteristicas-no-gaussianas"},"Caracteristicas no gaussianas"),(0,r.kt)("p",null,"Cuando encontramos caracteristicas que no son gaussianas, se debe\naplicar una transformaci\xf3n a los datos para que se vuelvan gaussianos."),(0,r.kt)("p",null,"por ejemplo: ","*"," ","$"," x_1 = (x_1) ","$"," ","*"," ","$"," x_2 = (x_2 + c) ","$"," ","*"," ","$"," x_3 =\n","$"," ","*"," ","$"," x_4 = x_4^{1/3} ","$"),(0,r.kt)("p",null,"En python"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from scipy.stats import skewnorm\nimport matplotlib.pyplot as plt\n\nnumValues = 1000\nmaxValue = 100\nskewness = 20\n\nrandomValues = skewnorm.rvs(a=skewness, loc=maxValue, size=numValues)\n\nrandomValues = randomValues - min(randomValues) # cambia el conjunto de datos para que comience en 0\nrandomValues = randomValues / max(randomValues) # cambia el conjunto de datos para que termine en 1\nrandomValues = randomValues * maxValue # cambia el conjunto de datos para que termine en maxValue\n\nx = randomValues\n\nfig, ax = plt.subplots(1, 3, figsize=(15, 5))\n\nax[0].hist(x, bins=50)\nax[0].set_title('X')\n\n# x**2\nax[1].hist(x**2, bins=50)\nax[1].set_title('X^2')\n\n# x**0.4\nax[2].hist(x**0.4, bins=50)\nax[2].set_title('X^0.4')\n\nplt.show()\n")),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(2941).Z,width:"1209",height:"451"})),(0,r.kt)("h3",{id:"error-en-el-analisis-para-detecci\xf3n-de-anomal\xedas"},"Error en el analisis para detecci\xf3n de anomal\xedas"),(0,r.kt)("p",null,"El problema m\xe1s com\xfan en la detecci\xf3n de anomal\xedas es que el conjunto de\ndatos de entrenamiento contiene muy pocos ejemplos de anomal\xedas. Por lo\ntanto, el algoritmo de detecci\xf3n de anomal\xedas no puede aprender lo\nsuficiente sobre los ejemplos de anomal\xedas para identificarlos\ncorrectamente en el conjunto de prueba."))}p.isMDXComponent=!0},6026:(e,a,n)=>{n.d(a,{Z:()=>t});const t=n.p+"assets/images/c413fab9-1-image-d5f3ec1284b8c99b0adc214bf6760777.png"},2941:(e,a,n)=>{n.d(a,{Z:()=>t});const t=n.p+"assets/images/cell-2-output-1-b98a90524ba1e76cc6d23aa787360d51.png"}}]);